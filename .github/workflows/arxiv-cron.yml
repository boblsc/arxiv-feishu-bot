name: Daily arXiv push to Feishu (classification)

on:
  schedule:
    # 每天 16:00 UTC 触发（≈ 洛杉矶早上 09:00，夏令时期间）
    - cron: '0 1 * * *'
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install deps
        run: |
          python -m pip install --upgrade pip
          pip install requests beautifulsoup4

      - name: Push to Feishu
        env:
          # 必填：从仓库 Settings → Secrets and variables → Actions 添加
          WEBHOOK_URL:        ${{ secrets.FEISHU_WEBHOOK_URL }}
          ARXIV_QUERY:        ${{ secrets.ARXIV_QUERY }}          # 例：dark matter OR neutrino OR TPC OR xenon OR argon OR WIMP OR CEvNS
          ARXIV_CLASSES:      ${{ secrets.ARXIV_CLASSES }}        # 例：hep-th,hep-ex,hep-ph,nucl-ex,physics.ins-det

          # 可选：不设则用脚本默认
          REQUIRE_PHYSICS_GROUP: "1"       # 1=同时要求 classification:physics
          RESULT_SIZE: "50"                # 网页每页数量（上限 200）
          ORDER: "-announced_date_first"   # 网页排序
          HIDE_ABSTRACTS: "True"           # 隐藏摘要
          TOP_SEND: "10"                   # 实际推送条数上限
          DAYS: "0"                        # 0=不限时间；1=仅最近一天
        run: |
          python arxiv_to_feishu.py
